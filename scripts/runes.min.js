$(document).ready(function(){function c(){g(),d()}function e(c){var e=$(c).parent().siblings(".level").text(),g=parseInt($(c).siblings("input").val(),10);console.log("level: "+e),console.log("slider: "+g),console.log(o[e][g]),$("#level"+e+" .cc div").text(o[e][g].cc),$("#level"+e+" .gd div").text(o[e][g].gd)}function g(){i=0,s=0,r=0;for(var c=o.length-1;c>0;c--){var e=0;if(c<o.length-1){var e=parseInt($("#level"+(c+1)+" .need").text(),10);parseInt($("#level"+(c+1)+" .want input").val(),10)-parseInt($("#level"+(c+1)+" .have input").val(),10)}var g=parseInt($("#level"+c+" .want input").val(),10),d=parseInt($("#level"+c+" .have input").val(),10),t=Math.max(2*e-d+g,0);$("#level"+c+" .need").text(t)}}function d(){for(var c=o.length-1;c>0;c--)if(c>1){var e=parseInt($("#level"+(c-1)+" .need").html(),10),g=parseInt($("#level"+(c-1)+" .have input").val(),10),d=parseInt($("#level"+c+" .need").html(),10),n=Math.min((e+g)/2,d),v=n*parseInt($("#level"+c+" .cc div").html(),10),u=parseInt($("#level"+c+" .gd div").html(),10);if(d>0){var h=d*(u*l),p=t(h);i+=u*d,$("#level"+c).find(".cost .gold").text(p[0]),$("#level"+c).find(".cost .silver").text(p[1]),$("#level"+c).find(".cost .copper").text(p[2])}$("#level"+c+" .cost .ccs").html(v),s+=v}r=parseInt($("#level1 .need").text(),10)*a+i*l,$("#use_ah input").attr("checked")&&(r+=s*(1e4*Math.max(parseInt($("#cc_ah_cost").val(),10),0)));var f=t(r);$("#total_gold_cost .gold").html(f[0]),$("#total_gold_cost .silver").html(f[1]),$("#total_gold_cost .copper").html(f[2]),$("#total_gds .amount").html(i),$("#total_ccs .amount").html(s)}function t(c){c=n(c,6);var e=parseInt(c.substring(c.length-2,c.length),10),g=parseInt(c.substring(c.length-4,c.length-2),10),d=parseInt(c.substring(0,c.length-4),10);return[d,g,e]}function n(c,e){for(var g=""+c;g.length<e;)g="0"+g;return g}$(".row .ratio input").val(0),$(".row .have input").val(0),$(".row .want input").val(0),$(".row .need").text("0"),$("#use_ah input[name='use_ah']").removeAttr("checked");var l=81,a=4500,i=0,s=0,r=0,o=[];o[2]=[],o[2][-7]={cc:28,gd:384e4},o[2][-6]={cc:31,gd:192e4},o[2][-5]={cc:34,gd:96e4},o[2][-4]={cc:38,gd:48e4},o[2][-3]={cc:41,gd:24e4},o[2][-2]={cc:45,gd:12e4},o[2][-1]={cc:50,gd:6e4},o[2][0]={cc:55,gd:3e4},o[2][1]={cc:61,gd:15e3},o[2][2]={cc:67,gd:7500},o[2][3]={cc:73,gd:3750},o[2][4]={cc:81,gd:1875},o[2][5]={cc:89,gd:938},o[2][6]={cc:97,gd:469},o[2][7]={cc:107,gd:234},o[3]=[],o[3][-7]={cc:43,gd:576e4},o[3][-6]={cc:57,gd:288e4},o[3][-5]={cc:52,gd:144e4},o[3][-4]={cc:57,gd:72e4},o[3][-3]={cc:62,gd:36e4},o[3][-2]={cc:69,gd:18e4},o[3][-1]={cc:75,gd:9e4},o[3][0]={cc:83,gd:45e3},o[3][1]={cc:91,gd:22500},o[3][2]={cc:100,gd:11250},o[3][3]={cc:110,gd:5625},o[3][4]={cc:122,gd:2813},o[3][5]={cc:134,gd:1406},o[3][6]={cc:147,gd:703},o[3][7]={cc:352,gd:162},o[4]=[],o[4][-7]={cc:64,gd:864e4},o[4][-6]={cc:70,gd:432e4},o[4][-5]={cc:77,gd:216e4},o[4][-4]={cc:85,gd:108e4},o[4][-3]={cc:93,gd:54e4},o[4][-2]={cc:102,gd:27e4},o[4][-1]={cc:113,gd:135e3},o[4][0]={cc:124,gd:67500},o[4][1]={cc:136,gd:33750},o[4][2]={cc:150,gd:16875},o[4][3]={cc:165,gd:8438},o[4][4]={cc:182,gd:4219},o[4][5]={cc:200,gd:2109},o[4][6]={cc:220,gd:1055},o[4][7]={cc:242,gd:527},o[5]=[],o[5][-7]={cc:95,gd:1296e4},o[5][-6]={cc:105,gd:648e4},o[5][-5]={cc:115,gd:324e4},o[5][-4]={cc:127,gd:162e4},o[5][-3]={cc:140,gd:81e4},o[5][-2]={cc:154,gd:405e3},o[5][-1]={cc:169,gd:202500},o[5][0]={cc:186,gd:101250},o[5][1]={cc:205,gd:50625},o[5][2]={cc:225,gd:25313},o[5][3]={cc:248,gd:12656},o[5][4]={cc:272,gd:6328},o[5][5]={cc:300,gd:3164},o[5][6]={cc:330,gd:1582},o[5][7]={cc:362,gd:791},o[6]=[],o[6][-7]={cc:143,gd:1944e4},o[6][-6]={cc:157,gd:972e4},o[6][-5]={cc:173,gd:486e4},o[6][-4]={cc:190,gd:243e4},o[6][-3]={cc:209,gd:1215e3},o[6][-2]={cc:230,gd:607500},o[6][-1]={cc:253,gd:303750},o[6][0]={cc:278,gd:151875},o[6][1]={cc:306,gd:75938},o[6][2]={cc:336,gd:37969},o[6][3]={cc:370,gd:18984},o[6][4]={cc:407,gd:9492},o[6][5]={cc:448,gd:4746},o[6][6]={cc:492,gd:2373},o[6][7]={cc:542,gd:1187},o[7]=[],o[7][-7]={cc:215,gd:29160064},o[7][-6]={cc:236,gd:14580032},o[7][-5]={cc:260,gd:7290016},o[7][-4]={cc:285,gd:3645008},o[7][-3]={cc:314,gd:1822504},o[7][-2]={cc:345,gd:911252},o[7][-1]={cc:380,gd:455626},o[7][0]={cc:418,gd:227813},o[7][1]={cc:460,gd:113907},o[7][2]={cc:506,gd:56953},o[7][3]={cc:556,gd:28477},o[7][4]={cc:612,gd:14238},o[7][5]={cc:673,gd:7119},o[7][6]={cc:741,gd:3560},o[7][7]={cc:815,gd:1780},o[8]=[],o[8][-7]={cc:321,gd:43740032},o[8][-6]={cc:353,gd:21870016},o[8][-5]={cc:389,gd:10935008},o[8][-4]={cc:428,gd:5467504},o[8][-3]={cc:470,gd:2733752},o[8][-2]={cc:517,gd:1366876},o[8][-1]={cc:569,gd:683438},o[8][0]={cc:626,gd:341719},o[8][1]={cc:689,gd:170860},o[8][2]={cc:757,gd:85430},o[8][3]={cc:833,gd:42715},o[8][4]={cc:917,gd:21357},o[8][5]={cc:1008,gd:10679},o[8][6]={cc:1109,gd:5339},o[8][7]={cc:1220,gd:2670},o[9]=[],o[9][-7]={cc:482,gd:65609984},o[9][-6]={cc:531,gd:32804992},o[9][-5]={cc:584,gd:16402496},o[9][-4]={cc:642,gd:8201248},o[9][-3]={cc:706,gd:4100624},o[9][-2]={cc:777,gd:2050312},o[9][-1]={cc:855,gd:1025156},o[9][0]={cc:940,gd:512578},o[9][1]={cc:1034,gd:256289},o[9][2]={cc:1137,gd:128145},o[9][3]={cc:1251,gd:64072},o[9][4]={cc:1376,gd:32036},o[9][5]={cc:1514,gd:16018},o[9][6]={cc:1665,gd:8009},o[9][7]={cc:1832,gd:4005},o[10]=[],o[10][-7]={cc:724,gd:98414976},o[10][-6]={cc:796,gd:49207488},o[10][-5]={cc:875,gd:24603744},o[10][-4]={cc:963,gd:12301872},o[10][-3]={cc:1059,gd:6150936},o[10][-2]={cc:1165,gd:3075468},o[10][-1]={cc:1282,gd:1537734},o[10][0]={cc:1410,gd:768867},o[10][1]={cc:1551,gd:384434},o[10][2]={cc:1706,gd:192217},o[10][3]={cc:1877,gd:96108},o[10][4]={cc:2064,gd:48054},o[10][5]={cc:2271,gd:24027},o[10][6]={cc:2498,gd:12014},o[10][7]={cc:2748,gd:6007},o[11]=[],o[11][-7]={cc:1085,gd:147622528},o[11][-6]={cc:1193,gd:73811264},o[11][-5]={cc:1313,gd:36905632},o[11][-4]={cc:1444,gd:18452816},o[11][-3]={cc:1588,gd:9226408},o[11][-2]={cc:1747,gd:4613204},o[11][-1]={cc:1922,gd:2306602},o[11][0]={cc:2114,gd:1153301},o[11][1]={cc:2325,gd:576651},o[11][2]={cc:2558,gd:288325},o[11][3]={cc:2814,gd:144163},o[11][4]={cc:3095,gd:72081},o[11][5]={cc:3405,gd:36041},o[11][6]={cc:3745,gd:18020},o[11][7]={cc:4120,gd:9010},o[12]=[],o[12][-7]={cc:1628,gd:221e6},o[12][-6]={cc:1791,gd:11e7},o[12][-5]={cc:1970,gd:55e6},o[12][-4]={cc:2167,gd:27e6},o[12][-3]={cc:2383,gd:13e6},o[12][-2]={cc:2621,gd:6e6},o[12][-1]={cc:2884,gd:3e6},o[12][0]={cc:3172,gd:1e6},o[12][1]={cc:3489,gd:5e5},o[12][2]={cc:3838,gd:25e4},o[12][3]={cc:4221,gd:125e3},o[12][4]={cc:4643,gd:62500},o[12][5]={cc:5107,gd:31250},o[12][6]={cc:5618,gd:15625},o[12][7]={cc:6180,gd:7813},o[13]=[],o[13][-7]={cc:2441,gd:332e6},o[13][-6]={cc:2685,gd:166e6},o[13][-5]={cc:2954,gd:83e6},o[13][-4]={cc:3249,gd:41e6},o[13][-3]={cc:3574,gd:2e7},o[13][-2]={cc:3931,gd:1e7},o[13][-1]={cc:4325,gd:5e6},o[13][0]={cc:4757,gd:25e5},o[13][1]={cc:5233,gd:125e4},o[13][2]={cc:5756,gd:625e3},o[13][3]={cc:6332,gd:312500},o[13][4]={cc:6965,gd:156250},o[13][5]={cc:7661,gd:78125},o[13][6]={cc:8427,gd:39063},o[13][7]={cc:9270,gd:19531},$("#use_ah input").removeAttr("checked"),$("#use_ah input[name='use_ah']").change(function(){$(this).attr("checked")?$("#use_ah .hidden").show():$("#use_ah .hidden").hide(),c()}),$("#cc_ah_cost").blur(function(){c()});for(var v=2;v<o.length;v++)$("#level"+v+" .cc div").text(o[v][0].cc);for(var v=2;v<o.length;v++)$("#level"+v+" .gd div").text(o[v][0].gd);$(".col.ratio button.up").click(function(){var g=parseInt($(this).siblings("input").val());return 7>g&&$(this).siblings("input").val(g+1),e($(this)),c(),!1}),$(".col.ratio button.down").click(function(){var g=parseInt($(this).siblings("input").val());return g>-7&&$(this).siblings("input").val(g-1),e($(this)),c(),!1}),$(".col.want button.up").click(function(){var e=parseInt($(this).siblings("input").val());return $(this).siblings("input").val(e+1),c(),!1}),$(".col.want button.down").click(function(){var e=parseInt($(this).siblings("input").val());return e>0&&$(this).siblings("input").val(e-1),c(),!1}),$(".col.have button.up").click(function(){var e=parseInt($(this).siblings("input").val());return $(this).siblings("input").val(e+1),c(),!1}),$(".col.have button.down").click(function(){var e=parseInt($(this).siblings("input").val());return e>0&&$(this).siblings("input").val(e-1),c($(this).parent().parent()),!1}),$("#magic_ratio").click(function(){var g=[],d=1e4*Math.max(parseInt($("#cc_ah_cost").val(),10),0),t=!1;console.log("calculating...");for(var n=o.length-1;n>1;n--)if(parseInt($("#level"+n+" .need").html(),10)>0&&!t&&(t=!0),t){console.log("level "+n+" rune(s) found");for(var a=999999999999999,i=7;i>=-7;i--){var s=o[n][i].cc*d+o[n][i].gd*l;console.log("ratio "+i+" costs "+s),a>s&&(g[n]=i,a=s)}}else g[n]=0;for(var n=o.length-1;n>1;n--)$("#level"+n+" .ratio input").val(g[n]),e($("#level"+n+" .ratio button.down"));return c(),!1})});
